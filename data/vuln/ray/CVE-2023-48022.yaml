info:
  name: ray
  cve: CVE-2023-48022
  summary: 通过 Ray 作业提交 API 实现任意代码执行
  details: |
    Anyscale Ray 的作业提交 API 存在任意代码执行漏洞。
    远程攻击者可利用此漏洞在服务器上运行未授权的代码。
    厂商已确认该问题，但声明 Ray 并非设计用于严格受控网络环境之外的场景，
    此限制已在文档中说明。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 升级至 Ray 2.49.3 或更高版本。
    2. 仅允许受信任的来源访问作业提交 API。
    3. 将 Ray 部署在安全、隔离的网络环境中。
    4. 根据官方 Ray 安全指南审查并应用其他强化措施。
rule: version >= "0" && version < "2.49.3"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-48022
  - https://github.com/ray-project/ray/commit/978947083b1e192dba61ef653c863b11d56b0936
  - https://atlas.mitre.org/studies/AML.CS0023
  - https://bishopfox.com/blog/ray-versions-2-6-3-2-8-0
  - https://console.vulncheck.com/cve/CVE-2023-48022
  - https://docs.ray.io/en/latest/ray-security/index.html
  - https://github.com/advisories/GHSA-xg2h-7cxj-3gvh
  - https://github.com/honysyang/Ray
  - https://github.com/ray-project/ray
  - https://www.anyscale.com/blog/update-on-ray-cve-2023-48022-new-verification-tooling-available
  - https://www.oligo.security/blog/shadowray-attack-ai-workloads-actively-exploited-in-the-wild
  - https://www.vicarius.io/vsociety/posts/shadowray-cve-2023-48022-exploit
  - https://www.vulncheck.com/blog/initial-access-intelligence-august-2024