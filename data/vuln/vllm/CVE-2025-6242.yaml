info:
  name: vllm
  cve: CVE-2025-6242
  summary: vLLM 的 MediaConnector 类中存在服务器端请求伪造（SSRF）漏洞
  details: |
    vLLM 的 `MediaConnector` 类中存在一个服务器端请求伪造（SSRF）漏洞，具体位于 `load_from_url` 和 `load_from_url_async` 方法中。这些函数从用户提供的 URL 获取媒体内容时未对目标主机进行验证。这使得攻击者可以强制服务器向内部服务或本地主机发起请求，可能导致内网侦察、拒绝服务或与无保护的内部 API 进行交互。
    在像 `llm-d` 这样的容器化环境中，该问题尤其危险，因为被利用的 SSRF 可能用于干扰其他 Pod 或从内部端点提取敏感信息。尽管通过 `--allowed-local-media-path` 对 `file://` 协议进行了部分限制，但基于 HTTP/HTTPS 的 SSRF 仍然是一个严重威胁。
    此漏洞影响版本从 0.5.0 起至（但不包括）0.11.0。
  cvss: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:L/A:H
  severity: HIGH
  security_advise: |
    1. 将 vLLM 升级到 0.11.0 或更高版本。
    2. 实施域名/IP 白名单或黑名单机制以限制外部媒体获取行为。
    3. 在 `MediaConnector` 发起任何网络请求前添加主机名和 IP 地址校验逻辑。
    4. 审查内部服务暴露情况，并确保内部端点已正确实施身份认证和隔离措施。
rule: version >= "0.5.0" && version < "0.11.0"
references:
  - https://github.com/vllm-project/vllm/security/advisories/GHSA-3f6c-7fw2-ppm4
  - https://nvd.nist.gov/vuln/detail/CVE-2025-6242
  - https://github.com/vllm-project/vllm/commit/9d9a2b77f19f68262d5e469c4e82c0f6365ad72d
  - https://access.redhat.com/security/cve/CVE-2025-6242
  - https://bugzilla.redhat.com/show_bug.cgi?id=2373716
  - https://github.com/vllm-project/vllm