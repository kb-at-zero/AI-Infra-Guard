info:
  name: pyload-ng
  cve: CVE-2025-61773
  summary: 通过未经净化的 CNL 和验证码参数在 pyLoad 中存在的代码注入和 XSS 漏洞
  details: |
    pyLoad 的 Web 界面在验证码脚本端点和 Click'N'Load（CNL）Blueprint 中均存在输入验证不足的问题。这使得不受信任的用户输入能够被不安全地处理，从而允许攻击者将任意内容注入到 Web UI 或操纵请求处理流程。
    来自 HTTP 请求的用户提供的参数在被用于应用程序逻辑之前未经过充分验证或清理。当通过如 `/flash/addcrypted2` 等端点提交恶意载荷时，可能导致客户端代码执行（XSS）。
    一个概念验证表明，提交包含 JavaScript 的构造 GET 请求，并将其放入 `jk` 参数中可导致反射型 XSS：
    ```http
    GET /flash/addcrypted2?jk=function(){alert(1)}&crypted=12345 HTTP/1.1
    Host: 127.0.0.1:8000
    Content-Type: application/x-www-form-urlencoded
    ```
    成功利用该漏洞可能使攻击者伪装成管理员、窃取身份认证令牌并执行未经授权的操作，特别是当 Web UI 在没有访问限制的情况下公开暴露时。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 升级至 pyload-ng 版本 0.5.0b3.dev91 或更高版本。
    2. 对所有面向 Web 的端点中的用户提供的参数实施严格的输入清洗。
    3. 限制 pyLoad Web UI 的公网暴露；尽可能使用身份验证和网络分段措施。
    4. 监控与 `/flash/*` 端点相关的可疑活动日志。
rule: version >= "0" && version < "0.5.0b3.dev91"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-cjjf-27cc-pvmv
  - https://github.com/pyload/pyload/pull/4624
  - https://github.com/pyload/pyload/commit/5823327d0b797161c7195a1f660266d30a69f0ca
  - https://github.com/pyload/pyload