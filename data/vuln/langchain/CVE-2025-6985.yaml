info:
  name: langchain
  cve: CVE-2025-6985
  summary: LangChain 的 HTMLSectionSplitter 中存在不安全的 XSLT 解析导致的 XXE 漏洞
  details: |
    `langchain-text-splitters` 中的 `HTMLSectionSplitter` 类由于不安全的 XSLT 处理，容易受到 XML 外部实体（XXE）攻击。它在使用 `lxml.etree.parse()` 和 `lxml.etree.XSLT()` 时未进行适当限制，允许攻击者注入恶意的 XSLT 样式表。这些样式表可能通过 `document()` 函数导致本地文件泄露或服务器端请求伪造。在 lxml 4.9.x 及更早版本中，默认启用了外部实体；而在 5.0+ 版本中，虽然实体扩展受到限制，但除非强制使用如 `XSLTAccessControl` 等访问控制机制，否则 XSLT 函数仍可能存在风险。此漏洞可使未经身份验证的远程攻击者读取应用程序进程有权访问的敏感文件。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 将 `langchain-text-splitters` 升级至 0.3.9 或更高版本。
    2. 避免在 `HTMLSectionSplitter` 中使用自定义或不受信任的 XSLT 样式表。
    3. 在使用 lxml 进行 XSLT 转换时，应用 `XSLTAccessControl` 来限制文档访问。
rule: version >= "0" && version < "0.3.9"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-6985
  - https://github.com/langchain-ai/langchain/pull/31819
  - https://github.com/langchain-ai/langchain/commit/43eef435505a1c907227b724c0c760ad5fc01790
  - https://github.com/langchain-ai/langchain
  - https://huntr.com/bounties/cf78abbb-df3b-43de-b6ee-132b73ff8331