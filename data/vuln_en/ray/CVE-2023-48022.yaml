info:
  name: ray
  cve: CVE-2023-48022
  summary: Arbitrary code execution via Ray job submission API
  details: |
    Anyscale Ray is vulnerable to arbitrary code execution through its job submission API.
    A remote attacker can exploit this to run unauthorized code on the server.
    The vendor acknowledges the issue but states that Ray is not intended for use outside
    of strictly controlled network environments, as documented.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade to Ray version 2.49.3 or later.
    2. Restrict access to the job submission API to trusted sources only.
    3. Deploy Ray within secure, isolated network environments.
    4. Review and apply additional hardening measures per official Ray security guidelines.
rule: version >= "0" && version < "2.49.3"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2023-48022
  - https://github.com/ray-project/ray/commit/978947083b1e192dba61ef653c863b11d56b0936
  - https://atlas.mitre.org/studies/AML.CS0023
  - https://bishopfox.com/blog/ray-versions-2-6-3-2-8-0
  - https://console.vulncheck.com/cve/CVE-2023-48022
  - https://docs.ray.io/en/latest/ray-security/index.html
  - https://github.com/advisories/GHSA-xg2h-7cxj-3gvh
  - https://github.com/honysyang/Ray
  - https://github.com/ray-project/ray
  - https://www.anyscale.com/blog/update-on-ray-cve-2023-48022-new-verification-tooling-available
  - https://www.oligo.security/blog/shadowray-attack-ai-workloads-actively-exploited-in-the-wild
  - https://www.vicarius.io/vsociety/posts/shadowray-cve-2023-48022-exploit
  - https://www.vulncheck.com/blog/initial-access-intelligence-august-2024